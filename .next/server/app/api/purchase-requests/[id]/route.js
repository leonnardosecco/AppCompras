"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/purchase-requests/[id]/route";
exports.ids = ["app/api/purchase-requests/[id]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&page=%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&page=%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_User_Documents_Apps_Compras_src_app_api_purchase_requests_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/purchase-requests/[id]/route.ts */ \"(rsc)/./src/app/api/purchase-requests/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/purchase-requests/[id]/route\",\n        pathname: \"/api/purchase-requests/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/purchase-requests/[id]/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\User\\\\Documents\\\\Apps\\\\Compras\\\\src\\\\app\\\\api\\\\purchase-requests\\\\[id]\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_User_Documents_Apps_Compras_src_app_api_purchase_requests_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/purchase-requests/[id]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwdXJjaGFzZS1yZXF1ZXN0cyUyRiU1QmlkJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkZwdXJjaGFzZS1yZXF1ZXN0cyUyRiU1QmlkJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcHVyY2hhc2UtcmVxdWVzdHMlMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNVc2VyJTVDRG9jdW1lbnRzJTVDQXBwcyU1Q0NvbXByYXMlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q1VzZXIlNUNEb2N1bWVudHMlNUNBcHBzJTVDQ29tcHJhcyZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUMyQztBQUN4SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL3Npc3RlbWEtY29tcHJhcy8/ODcwZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxVc2VyXFxcXERvY3VtZW50c1xcXFxBcHBzXFxcXENvbXByYXNcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxccHVyY2hhc2UtcmVxdWVzdHNcXFxcW2lkXVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcHVyY2hhc2UtcmVxdWVzdHMvW2lkXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3B1cmNoYXNlLXJlcXVlc3RzL1tpZF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3B1cmNoYXNlLXJlcXVlc3RzL1tpZF0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxVc2VyXFxcXERvY3VtZW50c1xcXFxBcHBzXFxcXENvbXByYXNcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxccHVyY2hhc2UtcmVxdWVzdHNcXFxcW2lkXVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wdXJjaGFzZS1yZXF1ZXN0cy9baWRdL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&page=%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/purchase-requests/[id]/route.ts":
/*!*****************************************************!*\
  !*** ./src/app/api/purchase-requests/[id]/route.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_3__.PrismaClient();\n// GET - Buscar requisição de compra por ID\nasync function GET(request, { params }) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"N\\xe3o autorizado\"\n            }, {\n                status: 401\n            });\n        }\n        const { id } = params;\n        const purchaseRequest = await prisma.purchaseRequest.findUnique({\n            where: {\n                id\n            },\n            include: {\n                client: true,\n                project: true,\n                createdBy: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true\n                    }\n                },\n                approvedBy: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true\n                    }\n                },\n                items: true,\n                purchases: {\n                    include: {\n                        items: true\n                    }\n                }\n            }\n        });\n        if (!purchaseRequest) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Requisi\\xe7\\xe3o de compra n\\xe3o encontrada\"\n            }, {\n                status: 404\n            });\n        }\n        // Verificar se o usuário tem acesso\n        if (session.user.role !== \"ADMIN\" && purchaseRequest.createdById !== session.user.id) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Acesso negado a esta requisi\\xe7\\xe3o\"\n            }, {\n                status: 403\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(purchaseRequest);\n    } catch (error) {\n        console.error(\"Erro ao buscar requisi\\xe7\\xe3o de compra:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Erro ao buscar requisi\\xe7\\xe3o de compra\"\n        }, {\n            status: 500\n        });\n    }\n}\n// PUT - Atualizar requisição de compra\nasync function PUT(request, { params }) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"N\\xe3o autorizado\"\n            }, {\n                status: 401\n            });\n        }\n        const { id } = params;\n        const data = await request.json();\n        // Verificar se a requisição existe\n        const existingRequest = await prisma.purchaseRequest.findUnique({\n            where: {\n                id\n            },\n            include: {\n                items: true\n            }\n        });\n        if (!existingRequest) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Requisi\\xe7\\xe3o de compra n\\xe3o encontrada\"\n            }, {\n                status: 404\n            });\n        }\n        // Verificar se o usuário tem permissão\n        const isAdmin = session.user.role === \"ADMIN\";\n        const isOwner = existingRequest.createdById === session.user.id;\n        if (!isAdmin && !isOwner) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Voc\\xea n\\xe3o tem permiss\\xe3o para editar esta requisi\\xe7\\xe3o\"\n            }, {\n                status: 403\n            });\n        }\n        // Não permitir edição se já aprovada ou rejeitada (a menos que seja admin)\n        if (!isAdmin && existingRequest.status !== \"PENDING\") {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"N\\xe3o \\xe9 poss\\xedvel editar uma requisi\\xe7\\xe3o que j\\xe1 foi processada\"\n            }, {\n                status: 400\n            });\n        }\n        // Preparar dados de atualização\n        const updateData = {\n            title: data.title,\n            description: data.description,\n            clientId: data.clientId || null,\n            projectId: data.projectId || null,\n            priority: data.priority,\n            justification: data.justification,\n            neededByDate: data.neededByDate ? new Date(data.neededByDate) : null,\n            budgetLimit: data.budgetLimit || null,\n            comments: data.comments\n        };\n        // Transação para atualizar requisição e itens\n        const updatedRequest = await prisma.$transaction(async (tx)=>{\n            // 1. Atualizar requisição\n            const updated = await tx.purchaseRequest.update({\n                where: {\n                    id\n                },\n                data: updateData,\n                include: {\n                    client: true,\n                    project: true,\n                    items: true,\n                    createdBy: {\n                        select: {\n                            name: true\n                        }\n                    },\n                    approvedBy: {\n                        select: {\n                            name: true\n                        }\n                    }\n                }\n            });\n            // 2. Atualizar ou criar novos itens, se houver\n            if (Array.isArray(data.items)) {\n                // Deletar todos os itens existentes\n                await tx.purchaseRequestItem.deleteMany({\n                    where: {\n                        purchaseRequestId: id\n                    }\n                });\n                // Criar novos itens\n                await Promise.all(data.items.map((item)=>tx.purchaseRequestItem.create({\n                        data: {\n                            purchaseRequestId: id,\n                            description: item.description,\n                            quantity: item.quantity,\n                            unit: item.unit,\n                            estimatedPrice: item.estimatedPrice || null,\n                            justification: item.justification || null,\n                            urgency: item.urgency || \"NORMAL\"\n                        }\n                    })));\n            }\n            // Buscar novamente com os itens atualizados\n            return tx.purchaseRequest.findUnique({\n                where: {\n                    id\n                },\n                include: {\n                    client: true,\n                    project: true,\n                    items: true,\n                    createdBy: {\n                        select: {\n                            name: true\n                        }\n                    },\n                    approvedBy: {\n                        select: {\n                            name: true\n                        }\n                    }\n                }\n            });\n        });\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(updatedRequest);\n    } catch (error) {\n        console.error(\"Erro ao atualizar requisi\\xe7\\xe3o de compra:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Erro ao atualizar requisi\\xe7\\xe3o de compra\"\n        }, {\n            status: 500\n        });\n    }\n}\n// DELETE - Excluir requisição de compra\nasync function DELETE(request, { params }) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"N\\xe3o autorizado\"\n            }, {\n                status: 401\n            });\n        }\n        const { id } = params;\n        // Verificar se a requisição existe\n        const existingRequest = await prisma.purchaseRequest.findUnique({\n            where: {\n                id\n            },\n            include: {\n                purchases: true\n            }\n        });\n        if (!existingRequest) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Requisi\\xe7\\xe3o de compra n\\xe3o encontrada\"\n            }, {\n                status: 404\n            });\n        }\n        // Verificar se o usuário tem permissão\n        const isAdmin = session.user.role === \"ADMIN\";\n        const isOwner = existingRequest.createdById === session.user.id;\n        if (!isAdmin && !isOwner) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Voc\\xea n\\xe3o tem permiss\\xe3o para excluir esta requisi\\xe7\\xe3o\"\n            }, {\n                status: 403\n            });\n        }\n        // Verificar se já há compras associadas\n        if (existingRequest.purchases.length > 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"N\\xe3o \\xe9 poss\\xedvel excluir uma requisi\\xe7\\xe3o que possui compras associadas\"\n            }, {\n                status: 400\n            });\n        }\n        // Não permitir exclusão se já aprovada (a menos que seja admin)\n        if (!isAdmin && existingRequest.status === \"APPROVED\") {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"N\\xe3o \\xe9 poss\\xedvel excluir uma requisi\\xe7\\xe3o que j\\xe1 foi aprovada\"\n            }, {\n                status: 400\n            });\n        }\n        // Excluir requisição\n        await prisma.purchaseRequest.delete({\n            where: {\n                id\n            }\n        });\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true\n        });\n    } catch (error) {\n        console.error(\"Erro ao excluir requisi\\xe7\\xe3o de compra:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Erro ao excluir requisi\\xe7\\xe3o de compra\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9wdXJjaGFzZS1yZXF1ZXN0cy9baWRdL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUEwQztBQUNFO0FBQ0o7QUFDSztBQUU3QyxNQUFNSSxTQUFTLElBQUlELHdEQUFZQTtBQUUvQiwyQ0FBMkM7QUFDcEMsZUFBZUUsSUFDcEJDLE9BQWdCLEVBQ2hCLEVBQUVDLE1BQU0sRUFBOEI7SUFFdEMsSUFBSTtRQUNGLE1BQU1DLFVBQVUsTUFBTVAsMkRBQWdCQSxDQUFDQyxrREFBV0E7UUFFbEQsSUFBSSxDQUFDTSxTQUFTO1lBQ1osT0FBT1Isa0ZBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBaUIsR0FDMUI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU0sRUFBRUMsRUFBRSxFQUFFLEdBQUdMO1FBRWYsTUFBTU0sa0JBQWtCLE1BQU1ULE9BQU9TLGVBQWUsQ0FBQ0MsVUFBVSxDQUFDO1lBQzlEQyxPQUFPO2dCQUFFSDtZQUFHO1lBQ1pJLFNBQVM7Z0JBQ1BDLFFBQVE7Z0JBQ1JDLFNBQVM7Z0JBQ1RDLFdBQVc7b0JBQ1RDLFFBQVE7d0JBQ05SLElBQUk7d0JBQ0pTLE1BQU07d0JBQ05DLE9BQU87b0JBQ1Q7Z0JBQ0Y7Z0JBQ0FDLFlBQVk7b0JBQ1ZILFFBQVE7d0JBQ05SLElBQUk7d0JBQ0pTLE1BQU07d0JBQ05DLE9BQU87b0JBQ1Q7Z0JBQ0Y7Z0JBQ0FFLE9BQU87Z0JBQ1BDLFdBQVc7b0JBQ1RULFNBQVM7d0JBQ1BRLE9BQU87b0JBQ1Q7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUEsSUFBSSxDQUFDWCxpQkFBaUI7WUFDcEIsT0FBT2Isa0ZBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBc0MsR0FDL0M7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLG9DQUFvQztRQUNwQyxJQUNFSCxRQUFRa0IsSUFBSSxDQUFDQyxJQUFJLEtBQUssV0FDdEJkLGdCQUFnQmUsV0FB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UUFFQSxnRUFBZ0U7UUFDaEUsSUFBSSxDQUFDc0IsV0FBV0QsZ0JBQWdCckIsTUFBTSxLQUFLLFlBQVk7WUFDckQsT0FBT1gsa0ZBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBNEQsR0FDckU7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLHFCQUFxQjtRQUNyQixNQUFNUCxPQUFPUyxlQUFlLENBQUNzRCxNQUFNLENBQUM7WUFDbENwRCxPQUFPO2dCQUFFSDtZQUFHO1FBQ2Q7UUFFQSxPQUFPWixrRkFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQUUyRCxTQUFTO1FBQUs7SUFDM0MsRUFBRSxPQUFPMUQsT0FBTztRQUNkbUIsUUFBUW5CLEtBQUssQ0FBQywrQ0FBeUNBO1FBQ3ZELE9BQU9WLGtGQUFZQSxDQUFDUyxJQUFJLENBQ3RCO1lBQUVDLE9BQU87UUFBdUMsR0FDaEQ7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaXN0ZW1hLWNvbXByYXMvLi9zcmMvYXBwL2FwaS9wdXJjaGFzZS1yZXF1ZXN0cy9baWRdL3JvdXRlLnRzPzEzZTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXHJcbmltcG9ydCB7IGdldFNlcnZlclNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgnXHJcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCdcclxuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXHJcblxyXG5jb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KClcclxuXHJcbi8vIEdFVCAtIEJ1c2NhciByZXF1aXNpw6fDo28gZGUgY29tcHJhIHBvciBJRFxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKFxyXG4gIHJlcXVlc3Q6IFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cclxuKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKVxyXG5cclxuICAgIGlmICghc2Vzc2lvbikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ07Do28gYXV0b3JpemFkbycgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgaWQgfSA9IHBhcmFtc1xyXG5cclxuICAgIGNvbnN0IHB1cmNoYXNlUmVxdWVzdCA9IGF3YWl0IHByaXNtYS5wdXJjaGFzZVJlcXVlc3QuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjbGllbnQ6IHRydWUsXHJcbiAgICAgICAgcHJvamVjdDogdHJ1ZSxcclxuICAgICAgICBjcmVhdGVkQnk6IHtcclxuICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICAgICAgbmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGFwcHJvdmVkQnk6IHtcclxuICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICAgICAgbmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGl0ZW1zOiB0cnVlLFxyXG4gICAgICAgIHB1cmNoYXNlczoge1xyXG4gICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICBpdGVtczogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoIXB1cmNoYXNlUmVxdWVzdCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1JlcXVpc2nDp8OjbyBkZSBjb21wcmEgbsOjbyBlbmNvbnRyYWRhJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHNlIG8gdXN1w6FyaW8gdGVtIGFjZXNzb1xyXG4gICAgaWYgKFxyXG4gICAgICBzZXNzaW9uLnVzZXIucm9sZSAhPT0gJ0FETUlOJyAmJlxyXG4gICAgICBwdXJjaGFzZVJlcXVlc3QuY3JlYXRlZEJ5SWQgIT09IHNlc3Npb24udXNlci5pZFxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnQWNlc3NvIG5lZ2FkbyBhIGVzdGEgcmVxdWlzacOnw6NvJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHB1cmNoYXNlUmVxdWVzdClcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBidXNjYXIgcmVxdWlzacOnw6NvIGRlIGNvbXByYTonLCBlcnJvcilcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0Vycm8gYW8gYnVzY2FyIHJlcXVpc2nDp8OjbyBkZSBjb21wcmEnIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH1cclxufVxyXG5cclxuLy8gUFVUIC0gQXR1YWxpemFyIHJlcXVpc2nDp8OjbyBkZSBjb21wcmFcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChcclxuICByZXF1ZXN0OiBSZXF1ZXN0LFxyXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucylcclxuXHJcbiAgICBpZiAoIXNlc3Npb24pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdOw6NvIGF1dG9yaXphZG8nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGlkIH0gPSBwYXJhbXNcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG5cclxuICAgIC8vIFZlcmlmaWNhciBzZSBhIHJlcXVpc2nDp8OjbyBleGlzdGVcclxuICAgIGNvbnN0IGV4aXN0aW5nUmVxdWVzdCA9IGF3YWl0IHByaXNtYS5wdXJjaGFzZVJlcXVlc3QuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgIGluY2x1ZGU6IHsgaXRlbXM6IHRydWUgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoIWV4aXN0aW5nUmVxdWVzdCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1JlcXVpc2nDp8OjbyBkZSBjb21wcmEgbsOjbyBlbmNvbnRyYWRhJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHNlIG8gdXN1w6FyaW8gdGVtIHBlcm1pc3PDo29cclxuICAgIGNvbnN0IGlzQWRtaW4gPSBzZXNzaW9uLnVzZXIucm9sZSA9PT0gJ0FETUlOJ1xyXG4gICAgY29uc3QgaXNPd25lciA9IGV4aXN0aW5nUmVxdWVzdC5jcmVhdGVkQnlJZCA9PT0gc2Vzc2lvbi51c2VyLmlkXHJcbiAgICBcclxuICAgIGlmICghaXNBZG1pbiAmJiAhaXNPd25lcikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1ZvY8OqIG7Do28gdGVtIHBlcm1pc3PDo28gcGFyYSBlZGl0YXIgZXN0YSByZXF1aXNpw6fDo28nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBOw6NvIHBlcm1pdGlyIGVkacOnw6NvIHNlIGrDoSBhcHJvdmFkYSBvdSByZWplaXRhZGEgKGEgbWVub3MgcXVlIHNlamEgYWRtaW4pXHJcbiAgICBpZiAoIWlzQWRtaW4gJiYgZXhpc3RpbmdSZXF1ZXN0LnN0YXR1cyAhPT0gJ1BFTkRJTkcnKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnTsOjbyDDqSBwb3Nzw612ZWwgZWRpdGFyIHVtYSByZXF1aXNpw6fDo28gcXVlIGrDoSBmb2kgcHJvY2Vzc2FkYScgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFByZXBhcmFyIGRhZG9zIGRlIGF0dWFsaXphw6fDo29cclxuICAgIGNvbnN0IHVwZGF0ZURhdGE6IGFueSA9IHtcclxuICAgICAgdGl0bGU6IGRhdGEudGl0bGUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICBjbGllbnRJZDogZGF0YS5jbGllbnRJZCB8fCBudWxsLFxyXG4gICAgICBwcm9qZWN0SWQ6IGRhdGEucHJvamVjdElkIHx8IG51bGwsXHJcbiAgICAgIHByaW9yaXR5OiBkYXRhLnByaW9yaXR5LFxyXG4gICAgICBqdXN0aWZpY2F0aW9uOiBkYXRhLmp1c3RpZmljYXRpb24sXHJcbiAgICAgIG5lZWRlZEJ5RGF0ZTogZGF0YS5uZWVkZWRCeURhdGUgPyBuZXcgRGF0ZShkYXRhLm5lZWRlZEJ5RGF0ZSkgOiBudWxsLFxyXG4gICAgICBidWRnZXRMaW1pdDogZGF0YS5idWRnZXRMaW1pdCB8fCBudWxsLFxyXG4gICAgICBjb21tZW50czogZGF0YS5jb21tZW50c1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRyYW5zYcOnw6NvIHBhcmEgYXR1YWxpemFyIHJlcXVpc2nDp8OjbyBlIGl0ZW5zXHJcbiAgICBjb25zdCB1cGRhdGVkUmVxdWVzdCA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XHJcbiAgICAgIC8vIDEuIEF0dWFsaXphciByZXF1aXNpw6fDo29cclxuICAgICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IHR4LnB1cmNoYXNlUmVxdWVzdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICBjbGllbnQ6IHRydWUsXHJcbiAgICAgICAgICBwcm9qZWN0OiB0cnVlLFxyXG4gICAgICAgICAgaXRlbXM6IHRydWUsXHJcbiAgICAgICAgICBjcmVhdGVkQnk6IHtcclxuICAgICAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYXBwcm92ZWRCeToge1xyXG4gICAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgICBuYW1lOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyAyLiBBdHVhbGl6YXIgb3UgY3JpYXIgbm92b3MgaXRlbnMsIHNlIGhvdXZlclxyXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhLml0ZW1zKSkge1xyXG4gICAgICAgIC8vIERlbGV0YXIgdG9kb3Mgb3MgaXRlbnMgZXhpc3RlbnRlc1xyXG4gICAgICAgIGF3YWl0IHR4LnB1cmNoYXNlUmVxdWVzdEl0ZW0uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICB3aGVyZTogeyBwdXJjaGFzZVJlcXVlc3RJZDogaWQgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIENyaWFyIG5vdm9zIGl0ZW5zXHJcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICBkYXRhLml0ZW1zLm1hcCgoaXRlbTogYW55KSA9PlxyXG4gICAgICAgICAgICB0eC5wdXJjaGFzZVJlcXVlc3RJdGVtLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHVyY2hhc2VSZXF1ZXN0SWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGl0ZW0uZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIHVuaXQ6IGl0ZW0udW5pdCxcclxuICAgICAgICAgICAgICAgIGVzdGltYXRlZFByaWNlOiBpdGVtLmVzdGltYXRlZFByaWNlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBqdXN0aWZpY2F0aW9uOiBpdGVtLmp1c3RpZmljYXRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIHVyZ2VuY3k6IGl0ZW0udXJnZW5jeSB8fCAnTk9STUFMJ1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIClcclxuICAgICAgICApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEJ1c2NhciBub3ZhbWVudGUgY29tIG9zIGl0ZW5zIGF0dWFsaXphZG9zXHJcbiAgICAgIHJldHVybiB0eC5wdXJjaGFzZVJlcXVlc3QuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICBjbGllbnQ6IHRydWUsXHJcbiAgICAgICAgICBwcm9qZWN0OiB0cnVlLFxyXG4gICAgICAgICAgaXRlbXM6IHRydWUsXHJcbiAgICAgICAgICBjcmVhdGVkQnk6IHtcclxuICAgICAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYXBwcm92ZWRCeToge1xyXG4gICAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgICBuYW1lOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih1cGRhdGVkUmVxdWVzdClcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBhdHVhbGl6YXIgcmVxdWlzacOnw6NvIGRlIGNvbXByYTonLCBlcnJvcilcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0Vycm8gYW8gYXR1YWxpemFyIHJlcXVpc2nDp8OjbyBkZSBjb21wcmEnIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH1cclxufVxyXG5cclxuLy8gREVMRVRFIC0gRXhjbHVpciByZXF1aXNpw6fDo28gZGUgY29tcHJhXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUoXHJcbiAgcmVxdWVzdDogUmVxdWVzdCxcclxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpXHJcblxyXG4gICAgaWYgKCFzZXNzaW9uKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnTsOjbyBhdXRvcml6YWRvJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBpZCB9ID0gcGFyYW1zXHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHNlIGEgcmVxdWlzacOnw6NvIGV4aXN0ZVxyXG4gICAgY29uc3QgZXhpc3RpbmdSZXF1ZXN0ID0gYXdhaXQgcHJpc21hLnB1cmNoYXNlUmVxdWVzdC5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgaW5jbHVkZTogeyBwdXJjaGFzZXM6IHRydWUgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoIWV4aXN0aW5nUmVxdWVzdCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1JlcXVpc2nDp8OjbyBkZSBjb21wcmEgbsOjbyBlbmNvbnRyYWRhJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHNlIG8gdXN1w6FyaW8gdGVtIHBlcm1pc3PDo29cclxuICAgIGNvbnN0IGlzQWRtaW4gPSBzZXNzaW9uLnVzZXIucm9sZSA9PT0gJ0FETUlOJ1xyXG4gICAgY29uc3QgaXNPd25lciA9IGV4aXN0aW5nUmVxdWVzdC5jcmVhdGVkQnlJZCA9PT0gc2Vzc2lvbi51c2VyLmlkXHJcbiAgICBcclxuICAgIGlmICghaXNBZG1pbiAmJiAhaXNPd25lcikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1ZvY8OqIG7Do28gdGVtIHBlcm1pc3PDo28gcGFyYSBleGNsdWlyIGVzdGEgcmVxdWlzacOnw6NvJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHNlIGrDoSBow6EgY29tcHJhcyBhc3NvY2lhZGFzXHJcbiAgICBpZiAoZXhpc3RpbmdSZXF1ZXN0LnB1cmNoYXNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnTsOjbyDDqSBwb3Nzw612ZWwgZXhjbHVpciB1bWEgcmVxdWlzacOnw6NvIHF1ZSBwb3NzdWkgY29tcHJhcyBhc3NvY2lhZGFzJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTsOjbyBwZXJtaXRpciBleGNsdXPDo28gc2UgasOhIGFwcm92YWRhIChhIG1lbm9zIHF1ZSBzZWphIGFkbWluKVxyXG4gICAgaWYgKCFpc0FkbWluICYmIGV4aXN0aW5nUmVxdWVzdC5zdGF0dXMgPT09ICdBUFBST1ZFRCcpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdOw6NvIMOpIHBvc3PDrXZlbCBleGNsdWlyIHVtYSByZXF1aXNpw6fDo28gcXVlIGrDoSBmb2kgYXByb3ZhZGEnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeGNsdWlyIHJlcXVpc2nDp8Ojb1xyXG4gICAgYXdhaXQgcHJpc21hLnB1cmNoYXNlUmVxdWVzdC5kZWxldGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBleGNsdWlyIHJlcXVpc2nDp8OjbyBkZSBjb21wcmE6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdFcnJvIGFvIGV4Y2x1aXIgcmVxdWlzacOnw6NvIGRlIGNvbXByYScgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApXHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJHRVQiLCJyZXF1ZXN0IiwicGFyYW1zIiwic2Vzc2lvbiIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImlkIiwicHVyY2hhc2VSZXF1ZXN0IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaW5jbHVkZSIsImNsaWVudCIsInByb2plY3QiLCJjcmVhdGVkQnkiLCJzZWxlY3QiLCJuYW1lIiwiZW1haWwiLCJhcHByb3ZlZEJ5IiwiaXRlbXMiLCJwdXJjaGFzZXMiLCJ1c2VyIiwicm9sZSIsImNyZWF0ZWRCeUlkIiwiY29uc29sZSIsIlBVVCIsImRhdGEiLCJleGlzdGluZ1JlcXVlc3QiLCJpc0FkbWluIiwiaXNPd25lciIsInVwZGF0ZURhdGEiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiY2xpZW50SWQiLCJwcm9qZWN0SWQiLCJwcmlvcml0eSIsImp1c3RpZmljYXRpb24iLCJuZWVkZWRCeURhdGUiLCJEYXRlIiwiYnVkZ2V0TGltaXQiLCJjb21tZW50cyIsInVwZGF0ZWRSZXF1ZXN0IiwiJHRyYW5zYWN0aW9uIiwidHgiLCJ1cGRhdGVkIiwidXBkYXRlIiwiQXJyYXkiLCJpc0FycmF5IiwicHVyY2hhc2VSZXF1ZXN0SXRlbSIsImRlbGV0ZU1hbnkiLCJwdXJjaGFzZVJlcXVlc3RJZCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJpdGVtIiwiY3JlYXRlIiwicXVhbnRpdHkiLCJ1bml0IiwiZXN0aW1hdGVkUHJpY2UiLCJ1cmdlbmN5IiwiREVMRVRFIiwibGVuZ3RoIiwiZGVsZXRlIiwic3VjY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/purchase-requests/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            name: \"Credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Senha\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    throw new Error(\"Credenciais inv\\xe1lidas\");\n                }\n                const user = await prisma.user.findUnique({\n                    where: {\n                        email: credentials.email\n                    }\n                });\n                if (!user) {\n                    throw new Error(\"Credenciais inv\\xe1lidas\") // Mensagem genérica\n                    ;\n                }\n                const isPasswordValid = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_1__.compare)(credentials.password, user.password);\n                if (!isPasswordValid) {\n                    throw new Error(\"Credenciais inv\\xe1lidas\") // Mensagem genérica\n                    ;\n                }\n                return {\n                    id: user.id,\n                    email: user.email,\n                    name: user.name,\n                    role: user.role\n                };\n            }\n        })\n    ],\n    secret: process.env.NEXTAUTH_SECRET,\n    callbacks: {\n        async jwt ({ token, user }) {\n            if (user) {\n                token.id = user.id;\n                token.email = user.email;\n                token.name = user.name;\n                token.role = user.role;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            session.user.id = token.id;\n            session.user.email = token.email;\n            session.user.name = token.name;\n            session.user.role = token.role;\n            return session;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\",\n        error: \"/auth/error\"\n    },\n    session: {\n        strategy: \"jwt\",\n        maxAge: 60 * 60 * 24\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTZDO0FBQ1g7QUFFK0I7QUFFakUsTUFBTUcsU0FBUyxJQUFJSCx3REFBWUE7QUFFeEIsTUFBTUksY0FBK0I7SUFDMUNDLFdBQVc7UUFDVEgsMkVBQW1CQSxDQUFDO1lBQ2xCSSxNQUFNO1lBQ05DLGFBQWE7Z0JBQ1hDLE9BQU87b0JBQUVDLE9BQU87b0JBQVNDLE1BQU07Z0JBQVE7Z0JBQ3ZDQyxVQUFVO29CQUFFRixPQUFPO29CQUFTQyxNQUFNO2dCQUFXO1lBQy9DO1lBQ0EsTUFBTUUsV0FBVUwsV0FBVztnQkFDekIsSUFBSSxDQUFDQSxhQUFhQyxTQUFTLENBQUNELGFBQWFJLFVBQVU7b0JBQ2pELE1BQU0sSUFBSUUsTUFBTTtnQkFDbEI7Z0JBRUEsTUFBTUMsT0FBTyxNQUFNWCxPQUFPVyxJQUFJLENBQUNDLFVBQVUsQ0FBQztvQkFDeENDLE9BQU87d0JBQUVSLE9BQU9ELFlBQVlDLEtBQUs7b0JBQUM7Z0JBQ3BDO2dCQUVBLElBQUksQ0FBQ00sTUFBTTtvQkFDVCxNQUFNLElBQUlELE1BQU0sNEJBQXlCLG9CQUFvQjs7Z0JBQy9EO2dCQUVBLE1BQU1JLGtCQUFrQixNQUFNaEIsaURBQU9BLENBQUNNLFlBQVlJLFFBQVEsRUFBRUcsS0FBS0gsUUFBUTtnQkFDekUsSUFBSSxDQUFDTSxpQkFBaUI7b0JBQ3BCLE1BQU0sSUFBSUosTUFBTSw0QkFBeUIsb0JBQW9COztnQkFDL0Q7Z0JBRUEsT0FBTztvQkFDTEssSUFBSUosS0FBS0ksRUFBRTtvQkFDWFYsT0FBT00sS0FBS04sS0FBSztvQkFDakJGLE1BQU1RLEtBQUtSLElBQUk7b0JBQ2ZhLE1BQU1MLEtBQUtLLElBQUk7Z0JBQ2pCO1lBQ0Y7UUFDRjtLQUNEO0lBQ0RDLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZTtJQUNuQ0MsV0FBVztRQUNULE1BQU1DLEtBQUksRUFBRUMsS0FBSyxFQUFFWixJQUFJLEVBQUU7WUFDdkIsSUFBSUEsTUFBTTtnQkFDUlksTUFBTVIsRUFBRSxHQUFHSixLQUFLSSxFQUFFO2dCQUNsQlEsTUFBTWxCLEtBQUssR0FBR00sS0FBS04sS0FBSztnQkFDeEJrQixNQUFNcEIsSUFBSSxHQUFHUSxLQUFLUixJQUFJO2dCQUN0Qm9CLE1BQU1QLElBQUksR0FBR0wsS0FBS0ssSUFBSTtZQUN4QjtZQUNBLE9BQU9PO1FBQ1Q7UUFDQSxNQUFNQyxTQUFRLEVBQUVBLE9BQU8sRUFBRUQsS0FBSyxFQUFFO1lBQzlCQyxRQUFRYixJQUFJLENBQUNJLEVBQUUsR0FBR1EsTUFBTVIsRUFBRTtZQUMxQlMsUUFBUWIsSUFBSSxDQUFDTixLQUFLLEdBQUdrQixNQUFNbEIsS0FBSztZQUNoQ21CLFFBQVFiLElBQUksQ0FBQ1IsSUFBSSxHQUFHb0IsTUFBTXBCLElBQUk7WUFDOUJxQixRQUFRYixJQUFJLENBQUNLLElBQUksR0FBR08sTUFBTVAsSUFBSTtZQUM5QixPQUFPUTtRQUNUO0lBQ0Y7SUFDQUMsT0FBTztRQUNMQyxRQUFRO1FBQ1JDLE9BQU87SUFDVDtJQUNBSCxTQUFTO1FBQ1BJLFVBQVU7UUFDVkMsUUFBUSxLQUFLLEtBQUs7SUFDcEI7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2lzdGVtYS1jb21wcmFzLy4vc3JjL2xpYi9hdXRoLnRzPzY2OTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5pbXBvcnQgeyBjb21wYXJlIH0gZnJvbSAnYmNyeXB0anMnXG5pbXBvcnQgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tICduZXh0LWF1dGgnXG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2NyZWRlbnRpYWxzJ1xuXG5jb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KClcblxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XG4gIHByb3ZpZGVyczogW1xuICAgIENyZWRlbnRpYWxzUHJvdmlkZXIoe1xuICAgICAgbmFtZTogJ0NyZWRlbnRpYWxzJyxcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiBcIkVtYWlsXCIsIHR5cGU6IFwiZW1haWxcIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJTZW5oYVwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy5lbWFpbCB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcmVkZW5jaWFpcyBpbnbDoWxpZGFzJylcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBlbWFpbDogY3JlZGVudGlhbHMuZW1haWwgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlZGVuY2lhaXMgaW52w6FsaWRhcycpIC8vIE1lbnNhZ2VtIGdlbsOpcmljYVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNQYXNzd29yZFZhbGlkID0gYXdhaXQgY29tcGFyZShjcmVkZW50aWFscy5wYXNzd29yZCwgdXNlci5wYXNzd29yZClcbiAgICAgICAgaWYgKCFpc1Bhc3N3b3JkVmFsaWQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWRlbmNpYWlzIGludsOhbGlkYXMnKSAvLyBNZW5zYWdlbSBnZW7DqXJpY2FcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIHJvbGU6IHVzZXIucm9sZSxcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIF0sXG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVULCAvLyBNT1ZJRE8gcGFyYSAuZW52XG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIGp3dCh7IHRva2VuLCB1c2VyIH0pIHtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHRva2VuLmlkID0gdXNlci5pZFxuICAgICAgICB0b2tlbi5lbWFpbCA9IHVzZXIuZW1haWxcbiAgICAgICAgdG9rZW4ubmFtZSA9IHVzZXIubmFtZVxuICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlXG4gICAgICB9XG4gICAgICByZXR1cm4gdG9rZW5cbiAgICB9LFxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICBzZXNzaW9uLnVzZXIuaWQgPSB0b2tlbi5pZFxuICAgICAgc2Vzc2lvbi51c2VyLmVtYWlsID0gdG9rZW4uZW1haWxcbiAgICAgIHNlc3Npb24udXNlci5uYW1lID0gdG9rZW4ubmFtZVxuICAgICAgc2Vzc2lvbi51c2VyLnJvbGUgPSB0b2tlbi5yb2xlXG4gICAgICByZXR1cm4gc2Vzc2lvblxuICAgIH1cbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46ICcvYXV0aC9zaWduaW4nLFxuICAgIGVycm9yOiAnL2F1dGgvZXJyb3InLFxuICB9LFxuICBzZXNzaW9uOiB7XG4gICAgc3RyYXRlZ3k6ICdqd3QnLFxuICAgIG1heEFnZTogNjAgKiA2MCAqIDI0LCAvLyAxIGRpYVxuICB9XG59XG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiY29tcGFyZSIsIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJwcmlzbWEiLCJhdXRoT3B0aW9ucyIsInByb3ZpZGVycyIsIm5hbWUiLCJjcmVkZW50aWFscyIsImVtYWlsIiwibGFiZWwiLCJ0eXBlIiwicGFzc3dvcmQiLCJhdXRob3JpemUiLCJFcnJvciIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpc1Bhc3N3b3JkVmFsaWQiLCJpZCIsInJvbGUiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfU0VDUkVUIiwiY2FsbGJhY2tzIiwiand0IiwidG9rZW4iLCJzZXNzaW9uIiwicGFnZXMiLCJzaWduSW4iLCJlcnJvciIsInN0cmF0ZWd5IiwibWF4QWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&page=%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpurchase-requests%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5CApps%5CCompras&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();